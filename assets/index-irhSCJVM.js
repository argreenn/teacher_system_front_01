import{r as u,a as S,o as K,c as Q,d as $,f as k,F as W,g as l,w as a,h as r,G as X,x as Y,p as Z,H as ee,i as v,C as le,E as x}from"./index-V_K-0ma8.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"teacher-container"},oe={class:"search-bar"},ne={class:"pagination-container"},re={class:"dialog-footer"},de={__name:"index",setup(ie){const d=u([]),C=u([]),h=u(!1),D=u(0),b=u(10),w=u(1),V=S({keyword:""}),y=u("新增教师"),c=u(!1),M=u(null),o=S({id:null,name:"",teacherId:"",department:"",title:"",phone:"",email:""}),z={name:[{required:!0,message:"请输入教师姓名",trigger:"blur"}],teacherId:[{required:!0,message:"请输入工号",trigger:"blur"}],department:[{required:!0,message:"请选择所属学院",trigger:"change"}],title:[{required:!0,message:"请选择职称",trigger:"change"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]};K(()=>{U()});const U=()=>{h.value=!0;const t=[];for(let e=1;e<=65;e++)t.push({id:e,name:`教师${e}`,teacherId:`T${String(2024e3+e).padStart(6,"0")}`,department:["计算机学院","电子信息学院","经济管理学院","外国语学院"][Math.floor(Math.random()*4)],title:["教授","副教授","讲师","助教"][Math.floor(Math.random()*4)],phone:`1${Math.floor(Math.random()*9)+3}${String(Math.floor(Math.random()*1e8)).padStart(8,"0")}`,email:`teacher${e}@university.edu.cn`,updateTime:new Date(Date.now()-Math.floor(Math.random()*30)*24*60*60*1e3).toLocaleString()});t.sort((e,i)=>new Date(i.updateTime)-new Date(e.updateTime)),d.value=t,f(),h.value=!1},f=()=>{const t=V.keyword.toLowerCase(),e=t?d.value.filter(i=>i.name.toLowerCase().includes(t)||i.teacherId.toLowerCase().includes(t)):[...d.value];D.value=e.length,B(e)},B=t=>{const e=(w.value-1)*b.value,i=e+b.value;C.value=t.slice(e,i)},E=()=>{h.value=!0,setTimeout(()=>{f(),h.value=!1},300)},L=()=>{w.value=1,E()},q=t=>{b.value=t,f()},F=t=>{w.value=t,f()},j=()=>{y.value="新增教师",Object.keys(o).forEach(t=>{o[t]=t==="id"?null:""}),c.value=!0},N=t=>{y.value="编辑教师",Object.keys(o).forEach(e=>{o[e]=t[e]}),c.value=!0},R=t=>{le.confirm(`确定删除教师"${t.name}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=d.value.findIndex(i=>i.id===t.id);e!==-1&&(d.value.splice(e,1),x.success("删除成功"),f())}).catch(()=>{})},O=async()=>{try{if(await M.value.validate(),o.id){const t=d.value.findIndex(e=>e.id===o.id);t!==-1&&(d.value[t]={...o,updateTime:new Date().toLocaleString()},x.success("更新成功"))}else{const t={...o,id:d.value.length>0?Math.max(...d.value.map(e=>e.id))+1:1,updateTime:new Date().toLocaleString()};d.value.unshift(t),x.success("添加成功")}f(),c.value=!1}catch(t){console.log("表单验证失败",t)}};return(t,e)=>{const i=r("el-icon"),_=r("el-input"),m=r("el-form-item"),g=r("el-button"),T=r("el-form"),s=r("el-table-column"),P=r("el-table"),A=r("el-pagination"),p=r("el-option"),I=r("el-select"),G=r("el-dialog"),H=X("loading");return $(),Q("div",ae,[k("div",oe,[l(T,{inline:!0,model:V,class:"form-inline search-form"},{default:a(()=>[l(m,null,{default:a(()=>[l(_,{modelValue:V.keyword,"onUpdate:modelValue":e[0]||(e[0]=n=>V.keyword=n),placeholder:"请输入教师姓名或工号",clearable:""},{prefix:a(()=>[l(i,null,{default:a(()=>[l(Z(ee))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(m,null,{default:a(()=>[l(g,{type:"primary",onClick:L},{default:a(()=>e[9]||(e[9]=[v("查询")])),_:1}),l(g,{type:"success",onClick:j},{default:a(()=>e[10]||(e[10]=[v("新增教师")])),_:1})]),_:1})]),_:1},8,["model"])]),W(($(),Y(P,{data:C.value,style:{width:"100%"},border:"","highlight-current-row":""},{default:a(()=>[l(s,{prop:"id",label:"ID",width:"80"}),l(s,{prop:"name",label:"姓名",width:"120"}),l(s,{prop:"teacherId",label:"工号",width:"120"}),l(s,{prop:"department",label:"所属学院",width:"150"}),l(s,{prop:"title",label:"职称",width:"120"}),l(s,{prop:"phone",label:"联系电话",width:"150"}),l(s,{prop:"email",label:"邮箱",width:"180"}),l(s,{prop:"updateTime",label:"更新时间",width:"180",sortable:""}),l(s,{label:"操作",width:"150",fixed:"right","class-name":"operation-column"},{default:a(n=>[l(g,{type:"primary",size:"small",onClick:J=>N(n.row)},{default:a(()=>e[11]||(e[11]=[v("编辑")])),_:2},1032,["onClick"]),l(g,{type:"danger",size:"small",onClick:J=>R(n.row)},{default:a(()=>e[12]||(e[12]=[v("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,h.value]]),k("div",ne,[l(A,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:D.value,"current-page":w.value,"page-size":b.value,"page-sizes":[10,15,30,50],onSizeChange:q,onCurrentChange:F},null,8,["total","current-page","page-size"])]),l(G,{title:y.value,modelValue:c.value,"onUpdate:modelValue":e[8]||(e[8]=n=>c.value=n),width:"600px","close-on-click-modal":!1},{footer:a(()=>[k("div",re,[l(g,{onClick:e[7]||(e[7]=n=>c.value=!1)},{default:a(()=>e[13]||(e[13]=[v("取消")])),_:1}),l(g,{type:"primary",onClick:O},{default:a(()=>e[14]||(e[14]=[v("确定")])),_:1})])]),default:a(()=>[l(T,{model:o,rules:z,ref_key:"teacherFormRef",ref:M,"label-width":"100px"},{default:a(()=>[l(m,{label:"姓名",prop:"name"},{default:a(()=>[l(_,{modelValue:o.name,"onUpdate:modelValue":e[1]||(e[1]=n=>o.name=n)},null,8,["modelValue"])]),_:1}),l(m,{label:"工号",prop:"teacherId"},{default:a(()=>[l(_,{modelValue:o.teacherId,"onUpdate:modelValue":e[2]||(e[2]=n=>o.teacherId=n)},null,8,["modelValue"])]),_:1}),l(m,{label:"所属学院",prop:"department"},{default:a(()=>[l(I,{modelValue:o.department,"onUpdate:modelValue":e[3]||(e[3]=n=>o.department=n),placeholder:"请选择学院",style:{width:"100%"}},{default:a(()=>[l(p,{label:"计算机学院",value:"计算机学院"}),l(p,{label:"电子信息学院",value:"电子信息学院"}),l(p,{label:"经济管理学院",value:"经济管理学院"}),l(p,{label:"外国语学院",value:"外国语学院"})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"职称",prop:"title"},{default:a(()=>[l(I,{modelValue:o.title,"onUpdate:modelValue":e[4]||(e[4]=n=>o.title=n),placeholder:"请选择职称",style:{width:"100%"}},{default:a(()=>[l(p,{label:"教授",value:"教授"}),l(p,{label:"副教授",value:"副教授"}),l(p,{label:"讲师",value:"讲师"}),l(p,{label:"助教",value:"助教"})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"联系电话",prop:"phone"},{default:a(()=>[l(_,{modelValue:o.phone,"onUpdate:modelValue":e[5]||(e[5]=n=>o.phone=n)},null,8,["modelValue"])]),_:1}),l(m,{label:"邮箱",prop:"email"},{default:a(()=>[l(_,{modelValue:o.email,"onUpdate:modelValue":e[6]||(e[6]=n=>o.email=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},me=te(de,[["__scopeId","data-v-4106d019"]]);export{me as default};
