import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as i,a as I,o as me,c as pe,d as $,g as l,w as t,h as u,f as c,i as v,t as ce,x as F,m as z,E as f,C as j}from"./index-D3eQVht4.js";const ge={class:"system-container"},ve={class:"settings-panel"},fe={class:"user-panel"},_e={class:"card-header"},we={class:"pagination-container"},be={class:"log-panel"},Ve={class:"card-header"},he={class:"pagination-container"},ye={class:"dialog-footer"},Ce={__name:"system",setup(Ue){const E=i("settings"),O=i(null),m=I({systemName:"教师系统管理平台",schoolName:"某某大学",adminEmail:"admin@university.edu.cn",announcement:"欢迎使用教师系统管理平台，该系统主要用于教师信息管理和教学业绩统计。"}),N=i([]),U=i(0),x=i(1),g=i([]),C=i([]),b=i(0),_=i([]),V=i(1),h=i([]),w=i(!1),k=i("新增用户"),B=i(null),n=I({id:null,username:"",name:"",role:"teacher",email:"",password:"",confirmPassword:"",status:1}),A={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,message:"用户名长度不能小于3个字符",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur",required:a=>!a.id},{min:6,message:"密码长度不能小于6个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur",required:a=>!a.id},{validator:(a,e,s)=>{e!==n.password?s(new Error("两次输入的密码不一致")):s()},trigger:"blur"}]};me(()=>{J(),Q()});const G=()=>{setTimeout(()=>{f.success("系统设置保存成功")},300)},H=()=>{m.systemName="教师系统管理平台",m.schoolName="某某大学",m.adminEmail="admin@university.edu.cn",m.announcement="欢迎使用教师系统管理平台，该系统主要用于教师信息管理和教学业绩统计。",f.success("系统设置已重置")},J=()=>{setTimeout(()=>{const a=[];for(let e=1;e<=25;e++)a.push({id:e,username:e===1?"admin":`teacher${e-1}`,name:e===1?"系统管理员":`教师${e-1}`,role:e===1?"admin":"teacher",email:e===1?"admin@university.edu.cn":`teacher${e-1}@university.edu.cn`,lastLogin:new Date(Date.now()-e*3600*1e3).toLocaleString(),status:Math.random()>.2?1:0});g.value=a,U.value=a.length,D()},300)},D=()=>{const a=(x.value-1)*10,e=a+10;N.value=g.value.slice(a,e)},K=a=>{x.value=a,D()},Q=()=>{setTimeout(()=>{const a=[];for(let e=1;e<=30;e++)a.push({id:e,username:e%3===0?"admin":`teacher${e%2+1}`,action:["登录","查询","新增","修改","删除"][e%5],description:`用户进行了${["登录系统","查询数据","新增记录","修改信息","删除数据"][e%5]}操作`,ip:`192.168.1.${e%255}`,time:new Date(Date.now()-e*3600*1e3).toLocaleString()});h.value=a,b.value=a.length,L()},300)},L=()=>{const a=(V.value-1)*10,e=a+10;C.value=h.value.slice(a,e)},W=()=>{k.value="新增用户",Object.keys(n).forEach(a=>{n[a]=a==="id"?null:a==="role"?"teacher":a==="status"?1:""}),w.value=!0},X=a=>{k.value="编辑用户",Object.keys(n).forEach(e=>{e!=="password"&&e!=="confirmPassword"?n[e]=a[e]:n[e]=""}),w.value=!0},Z=async()=>{try{if(await B.value.validate(),n.id){const a=g.value.findIndex(e=>e.id===n.id);a!==-1&&(g.value[a]={...g.value[a],name:n.name,role:n.role,email:n.email,status:n.status},f.success("更新用户成功"))}else{const a={id:g.value.length>0?Math.max(...g.value.map(e=>e.id))+1:1,username:n.username,name:n.name,role:n.role,email:n.email,lastLogin:"-",status:n.status};g.value.push(a),U.value++,f.success("添加用户成功")}D(),w.value=!1}catch(a){console.log("表单验证失败",a)}},ee=(a,e)=>{const s=a===1?"启用":"禁用",r=g.value.findIndex(p=>p.id===e.id);r!==-1&&(g.value[r].status=a),f.success(`已${s}用户: ${e.name}`)},le=a=>{j.confirm(`确定要重置用户"${a.name}"的密码吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{f.success(`已重置用户"${a.name}"的密码为: 123456`)}).catch(()=>{})},ae=()=>{if(_.value&&_.value.length===2){const a=new Date(_.value[0]).getTime(),e=new Date(_.value[1]).getTime()+24*60*60*1e3-1,s=h.value.filter(r=>{const p=new Date(r.time).getTime();return p>=a&&p<=e});b.value=s.length,C.value=s.slice(0,10),V.value=1,f.success(`已筛选出 ${s.length} 条日志记录`)}else b.value=h.value.length,L()},te=()=>{j.confirm("确定要清空所有日志记录吗？此操作不可恢复！","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{h.value=[],C.value=[],b.value=0,V.value=1,f.success("所有日志已清空")}).catch(()=>{})},oe=a=>{V.value=a,L()};return(a,e)=>{const s=u("el-input"),r=u("el-form-item"),p=u("el-button"),M=u("el-form"),T=u("el-card"),P=u("el-tab-pane"),d=u("el-table-column"),ne=u("el-tag"),q=u("el-switch"),Y=u("el-table"),R=u("el-pagination"),se=u("el-date-picker"),re=u("el-tabs"),S=u("el-option"),ue=u("el-select"),de=u("el-dialog");return $(),pe("div",ge,[l(re,{modelValue:E.value,"onUpdate:modelValue":e[5]||(e[5]=o=>E.value=o),type:"card"},{default:t(()=>[l(P,{label:"系统设置",name:"settings"},{default:t(()=>[c("div",ve,[l(T,{header:"基本设置"},{default:t(()=>[l(M,{"label-width":"120px",model:m,ref_key:"settingsFormRef",ref:O},{default:t(()=>[l(r,{label:"系统名称"},{default:t(()=>[l(s,{modelValue:m.systemName,"onUpdate:modelValue":e[0]||(e[0]=o=>m.systemName=o),placeholder:"请输入系统名称"},null,8,["modelValue"])]),_:1}),l(r,{label:"学校名称"},{default:t(()=>[l(s,{modelValue:m.schoolName,"onUpdate:modelValue":e[1]||(e[1]=o=>m.schoolName=o),placeholder:"请输入学校名称"},null,8,["modelValue"])]),_:1}),l(r,{label:"管理员邮箱"},{default:t(()=>[l(s,{modelValue:m.adminEmail,"onUpdate:modelValue":e[2]||(e[2]=o=>m.adminEmail=o),placeholder:"请输入管理员邮箱"},null,8,["modelValue"])]),_:1}),l(r,{label:"系统公告"},{default:t(()=>[l(s,{modelValue:m.announcement,"onUpdate:modelValue":e[3]||(e[3]=o=>m.announcement=o),type:"textarea",rows:"4",placeholder:"请输入系统公告内容"},null,8,["modelValue"])]),_:1}),l(r,null,{default:t(()=>[l(p,{type:"primary",onClick:G},{default:t(()=>e[15]||(e[15]=[v("保存设置")])),_:1}),l(p,{onClick:H},{default:t(()=>e[16]||(e[16]=[v("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),l(P,{label:"用户管理",name:"users"},{default:t(()=>[c("div",fe,[l(T,null,{header:t(()=>[c("div",_e,[e[18]||(e[18]=c("span",null,"系统用户列表",-1)),l(p,{type:"primary",onClick:W},{default:t(()=>e[17]||(e[17]=[v("新增用户")])),_:1})])]),default:t(()=>[l(Y,{data:N.value,border:"",style:{width:"100%"}},{default:t(()=>[l(d,{prop:"id",label:"ID",width:"80"}),l(d,{prop:"username",label:"用户名",width:"120"}),l(d,{prop:"name",label:"姓名",width:"120"}),l(d,{prop:"role",label:"角色",width:"100"},{default:t(o=>[l(ne,{type:o.row.role==="admin"?"danger":"primary"},{default:t(()=>[v(ce(o.row.role==="admin"?"管理员":"教师"),1)]),_:2},1032,["type"])]),_:1}),l(d,{prop:"email",label:"邮箱"}),l(d,{prop:"lastLogin",label:"最后登录时间",width:"180"}),l(d,{prop:"status",label:"状态",width:"100"},{default:t(o=>[l(q,{modelValue:o.row.status,"onUpdate:modelValue":y=>o.row.status=y,"active-value":1,"inactive-value":0,onChange:y=>ee(y,o.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(d,{label:"操作",width:"200","class-name":"operation-column"},{default:t(o=>[l(p,{type:"primary",size:"small",onClick:y=>X(o.row)},{default:t(()=>e[19]||(e[19]=[v(" 编辑 ")])),_:2},1032,["onClick"]),l(p,{type:"warning",size:"small",onClick:y=>le(o.row)},{default:t(()=>e[20]||(e[20]=[v(" 重置密码 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",we,[l(R,{background:"",layout:"total, prev, pager, next",total:U.value,"page-size":10,"current-page":x.value,onCurrentChange:K},null,8,["total","current-page"])])]),_:1})])]),_:1}),l(P,{label:"日志记录",name:"logs"},{default:t(()=>[c("div",be,[l(T,null,{header:t(()=>[c("div",Ve,[e[22]||(e[22]=c("span",null,"系统操作日志",-1)),c("div",null,[l(se,{modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=o=>_.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:ae},null,8,["modelValue"]),l(p,{type:"danger",onClick:te},{default:t(()=>e[21]||(e[21]=[v("清空日志")])),_:1})])])]),default:t(()=>[l(Y,{data:C.value,border:"",style:{width:"100%"}},{default:t(()=>[l(d,{prop:"id",label:"ID",width:"80"}),l(d,{prop:"username",label:"操作用户",width:"120"}),l(d,{prop:"action",label:"操作类型",width:"120"}),l(d,{prop:"description",label:"操作描述"}),l(d,{prop:"ip",label:"IP地址",width:"140"}),l(d,{prop:"time",label:"操作时间",width:"180"})]),_:1},8,["data"]),c("div",he,[l(R,{background:"",layout:"total, prev, pager, next",total:b.value,"page-size":10,"current-page":V.value,onCurrentChange:oe},null,8,["total","current-page"])])]),_:1})])]),_:1})]),_:1},8,["modelValue"]),l(de,{title:k.value,modelValue:w.value,"onUpdate:modelValue":e[14]||(e[14]=o=>w.value=o),width:"500px"},{footer:t(()=>[c("div",ye,[l(p,{onClick:e[13]||(e[13]=o=>w.value=!1)},{default:t(()=>e[23]||(e[23]=[v("取消")])),_:1}),l(p,{type:"primary",onClick:Z},{default:t(()=>e[24]||(e[24]=[v("确定")])),_:1})])]),default:t(()=>[l(M,{model:n,rules:A,ref_key:"userFormRef",ref:B,"label-width":"100px"},{default:t(()=>[l(r,{label:"用户名",prop:"username"},{default:t(()=>[l(s,{modelValue:n.username,"onUpdate:modelValue":e[6]||(e[6]=o=>n.username=o),disabled:n.id!==null},null,8,["modelValue","disabled"])]),_:1}),l(r,{label:"姓名",prop:"name"},{default:t(()=>[l(s,{modelValue:n.name,"onUpdate:modelValue":e[7]||(e[7]=o=>n.name=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"角色",prop:"role"},{default:t(()=>[l(ue,{modelValue:n.role,"onUpdate:modelValue":e[8]||(e[8]=o=>n.role=o),placeholder:"请选择角色",style:{width:"100%"}},{default:t(()=>[l(S,{label:"管理员",value:"admin"}),l(S,{label:"教师",value:"teacher"})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"邮箱",prop:"email"},{default:t(()=>[l(s,{modelValue:n.email,"onUpdate:modelValue":e[9]||(e[9]=o=>n.email=o)},null,8,["modelValue"])]),_:1}),n.id?z("",!0):($(),F(r,{key:0,label:"密码",prop:"password"},{default:t(()=>[l(s,{modelValue:n.password,"onUpdate:modelValue":e[10]||(e[10]=o=>n.password=o),type:"password","show-password":""},null,8,["modelValue"])]),_:1})),n.id?z("",!0):($(),F(r,{key:1,label:"确认密码",prop:"confirmPassword"},{default:t(()=>[l(s,{modelValue:n.confirmPassword,"onUpdate:modelValue":e[11]||(e[11]=o=>n.confirmPassword=o),type:"password","show-password":""},null,8,["modelValue"])]),_:1})),l(r,{label:"状态"},{default:t(()=>[l(q,{modelValue:n.status,"onUpdate:modelValue":e[12]||(e[12]=o=>n.status=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},De=ie(Ce,[["__scopeId","data-v-a5567d82"]]);export{De as default};
